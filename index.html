<div id='root'></div>
<script src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script src='https://unpkg.com/babel-standalone@6/babel.min.js'></script>
<script type='text/babel'>
// const rootElement = document.getElementById('root');
// const element = <div className='container'>Hello with jsx</div> 

class App extends React.Component{
  constructor(props) {
    super(props)  
    this.state = {
      value:"", items : []
    }
  } 
  handleChange = (event) => {
      this.setState({value:event.target.value})
      console.log(this.state.value)
  }
  addItem = () => {
    const itemsCopy = this.state.items.slice()
    const truncatedString = this.state.value.substring(0,20);
    itemsCopy.push({"title":truncatedString,"score":0})
    itemsCopy.sort((a,b)=>{
      return b.score - a.score;
    })
    this.setState({items:itemsCopy,value:""})
  }
  updateScore = (index,val) => {
    const itemsCopy = this.state.items.slice();
    itemsCopy[index].score += val;
    itemsCopy.sort((a,b) => {
        return b.score - a.score
    })
    this.setState({items:itemsCopy})
    console.log(this.state.items);
  }    
  render() {
    return (
      <div>
        <input value = { this.state.value } onChange = { this.handleChange }/>      
        <button onClick = { this.addItem }>Submit</button>  
        <PostList 
          postList = {this.state.items}
          updateScore = { this.updateScore }  
        />
      </div>
    )
  }
}

function PostList(props){
  return (
    <ol>
      {
        props.postList.map((item,index) => 
          <Post key = {index} 
            title = {item.title} 
            score = {item.score}
          />
        )
      }
    </ol>
  )  
}

function Post(props){
    var style = {
        display:"flex"
    }
    return (
        <div style = {style}>
            <PostButton label = "x"/>
            <PostText text = {props.title} width = "200"/>
            <PostButton label = "+" />
            <PostText text = {props.score} width = "20"/>
            <PostButton label = "-"/>
        </div>
    )
}

function PostText(props){
    var style = {
        border:"1px solid black",
        width: props.width
    }
    return (
        <div style = {style}>{props.text}</div>
    )
}

function PostButton(props) {
  var style = {
    width: 24,
    height: 24
  }
  return (
    <button style = {style}>{props.label}</button>
  )
}
// ReactDOM.render(element, rootElement)
ReactDOM.render(
  <App/>,
  document.getElementById('root')
)
</script>

